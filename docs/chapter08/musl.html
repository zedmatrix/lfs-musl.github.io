<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" type="text/css" href="../ymusl-lfs.css" />
    <title>8.5 - musl - 1.2.5</title>
  </head>
  <body class="ylfs" id="lfs-r1.0-1-musl-sysv-mdev">
  <div class="header">
    <div class="section">
      <h2>Linux From Scratch - musl</h2>
        <h3>Version r1.0-1-sysv-mdev</h3>
      <h3>8.5 - musl - 1.2.5</h3>

      <div class="padbox">
        <p class="info"><a href="https://musl.libc.org/">musl.libc.org</a> is an implementation of the C standard library built on top of the Linux system call API,
including interfaces defined in the base language standard, POSIX, and widely agreed-upon extensions.
musl is lightweight, fast, simple, free, and strives to be correct in the sense of standards-conformance and safety.</p>
      </div>

    </div>
  </div>

<div class="section">
  <div class="padbox">
    <h4>Sources</h4>    <p>
Download URL: <a href="https://musl.libc.org/releases/musl-1.2.5.tar.gz">https://musl.libc.org/releases/musl-1.2.5.tar.gz</a><br>
SHA256 Sum: <code>a9a118bbe84d8764da0ea0d28b3ab3fae8477fc7e4085d90102b8596fc7c75e4</code><br>
MD5 Sum: <code>ac5cfde7718d0547e224247ccfe59f18</code><br>
<br><p>Patch some vulnerabilities:</p>
Download URL: <a href="../sources/musl-1.2.5-iconv-fix.patch">sources/musl-1.2.5-iconv-fix.patch</a><br>
MD5 Sum: <code>952e83c12a192b35d3038bd76242119a</code><br>
<br><p>The malloc implementation used by Musl is slow. Apply the following patch to use rpmalloc as a faster alternative:</p>
Download URL: <a href="../sources/musl-1.2.5-rpmalloc.patch">sources/musl-1.2.5-rpmalloc.patch</a><br>
MD5 Sum: <code>57e25622ef642b5564952cd52194e501</code><br>
<br>
    </p>
  </div>
</div>

<div class="section">Prepare and Build Musl for compilation:<pre class="build">./configure --prefix=/usr --with-malloc=rpmalloc &&
make</pre></div>


<div class="section">Installation of Musl:<pre class="install">make install</pre></div>

<div class="section"><pre class="final">install -vm644 ${YSRC}/nsswitch.conf /etc/nsswitch.conf;
install -vm644 ${YSRC}/ld-musl-x86_64.path /etc/ld-musl-x86_64.path;
ln -sfv ../lib/ld-musl-x86_64.so.1 /usr/bin/ldd</pre>
Add the ldd program as a symlink to libc.</div>

<div class="section"><pre class="bash">cat &gt; ld-musl-x86_64.path &lt;&lt; "EOF"
# Begin /etc/ld.so.conf
/usr/lib
/usr/local/lib
/opt/lib</pre></div>

<div class="section"><pre class="bash">cat &gt; nsswitch.conf &lt;&lt; "EOF"
# Begin /etc/nsswitch.conf

passwd: files
group: files
shadow: files

hosts: files dns
networks: files

protocols: files
services: files
ethers: files
rpc: files

# End /etc/nsswitch.conf</pre></div>



</body></html>

